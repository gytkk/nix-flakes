{
  inputs = {
    nixpkgs.url = "github:nixos/nixpkgs/nixpkgs-unstable";
    nixpkgs-terraform.url = "github:stackbuilders/nixpkgs-terraform";
  };

  outputs = { self, nixpkgs, nixpkgs-terraform }:
    let
      # ì§€ì›í•˜ëŠ” ì‹œìŠ¤í…œ ëª©ë¡
      systems = [ "x86_64-linux" "aarch64-darwin" "aarch64-linux" "x86_64-darwin" ];
      
      # ê° ì‹œìŠ¤í…œì— ëŒ€í•´ outputs ìƒì„±
      forAllSystems = nixpkgs.lib.genAttrs systems;
      
      # Home Managerì—ì„œ ì£¼ì…ëœ ì„¤ì •ê°’ë“¤
      supportedVersions = @supportedVersions@;
      defaultVersion = "@defaultVersion@";
    in
    {
      devShells = forAllSystems (system:
        let
          pkgs = nixpkgs.legacyPackages.$${system};
          
          # ê° ë²„ì „ë³„ devShell ìƒì„±
          versionShells = builtins.listToAttrs (
            map (version: {
              name = "terraform-$${builtins.replaceStrings ["."] ["-"] version}";
              value = pkgs.mkShell {
                buildInputs = [ 
                  (if version == "latest" 
                    then pkgs.terraform
                    else nixpkgs-terraform.packages.$${system}.$${version})
                ];
                shellHook = ''
                  echo "ğŸš€ Terraform $${version} environment loaded"
                  terraform version
                '';
              };
            }) supportedVersions
          );
        in
        versionShells // {
          # ê¸°ë³¸ shellì€ defaultVersionì„ ì‚¬ìš©
          default = versionShells."terraform-$${builtins.replaceStrings ["."] ["-"] defaultVersion}";
        }
      );
    };
}